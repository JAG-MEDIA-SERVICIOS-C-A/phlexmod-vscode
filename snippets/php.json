{
  "MIA API Endpoint": {
    "prefix": "px-api",
    "body": [
      "<?php",
      "/** ",
      " * Nombre del Archivo: ${1:filename}.php",
      " * Descripción: ${2:Descripción del endpoint}",
      " * ",
      " * @package    PHLEXMOD-Framework",
      " * @subpackage ${3:Backend/modules/path}",
      " * @author     JAG-Media Servicios, C.A.",
      " * @version    v2.0.1",
      " * @since      ${CURRENT_YEAR}-${CURRENT_MONTH}-${CURRENT_DATE}",
      " * @license    Comercial Propietaria",
      " * @copyright  ${CURRENT_YEAR} JAG MEDIA SERVICIOS C.A.",
      " * @link       https://phlexmod.mia-architecture.com/",
      " */",
      "",
      "// Validar acceso directo",
      "if (!defined('PHLEXMOD_CORE_PATH')) {",
      "    // Intento de carga relativa si no está definido (fallback)",
      "    \\$coreConfig = __DIR__ . '${4:/../../../../../core-config.php}';",
      "    if (file_exists(\\$coreConfig)) require_once \\$coreConfig;",
      "}",
    "",
    "if (!defined('PHLEXMOD_CORE_PATH')) {",
    "    http_response_code(500);",
    "    exit('Error crítico: Core no inicializado.');",
    "}",
    "",
    "require_once PHLEXMOD_CORE_PATH . 'ConfigManager.php';",
    "require_once PHLEXMOD_CORE_PATH . 'SanitizerManager.php';",
    "require_once PHLEXMOD_CORE_PATH . 'Logger.php';",
    "",
    "header('Content-Type: application/json');",
    "",
    "// Validar sesión",
    "if (session_status() === PHP_SESSION_NONE) { session_name(PHLEXMOD_SESSION_NAME_WEB); session_start(); }",
    "if (!isset(\\$_SESSION['login']) || !\\$_SESSION['login']) { ",
    "    http_response_code(401);",
    "    echo json_encode(['status'=>'error', 'message'=>'Sesión no válida o expirada.']); ",
    "    exit; ",
    "}",
    "",
    "try {",
    "    // 1. Entrada (Sanitizer)",
    "    \\$${5:param} = Sanitizer::post('${5:param}', null, '${6:string}');",
    "",
    "    if (\\$${5:param} === null) {",
    "        throw new Exception('Parámetro requerido faltante: ${5:param}');",
    "    }",
    "",
    "    // 2. Proceso (Lógica + BD)",
    "    \\$sql = \"${7:SELECT * FROM table WHERE col = $1}\";",
    "    \\$res = pg_query_params(\\$conexion, \\$sql, array(\\$${5:param}));",
    "",
    "    if (!\\$res) {",
    "        // No exponer error de BD al usuario",
    "        Logger::error('DB Error en ${1:filename}: ' . pg_last_error(\\$conexion));",
    "        throw new Exception('Error interno al procesar la solicitud.');",
    "    }",
      "",
      "    \\$data = [];",
      "    while (\\$row = pg_fetch_assoc(\\$res)) {",
      "        \\$data[] = \\$row;",
      "    }",
      "",
      "    // 3. Salida",
      "    echo json_encode(['status' => 'success', 'data' => \\$data]);",
      "",
      "} catch (Exception \\$e) {",
      "    // Loguear el error real de forma segura",
      "    Logger::error(\"Excepción en ${1:filename}: \" . \\$e->getMessage());",
      "    ",
      "    // Responder genérico al cliente (Anti-InfoLeak)",
      "    http_response_code(500);",
      "    echo json_encode(['status' => 'error', 'message' => 'Error interno del servidor.']);",
      "} finally {",
      "    // Limpieza opcional",
      "    // if (isset(\\$conexion)) { pg_close(\\$conexion); }",
      "}",
      "?>"
    ],
    "description": "Template para un endpoint API en MIA (MIA Compliant: Logger + Sanitizer + Secure Error Handling)"
  },
  "MIA UI Module (BS5.3)": {
    "prefix": "px-ui",
    "body": [
      "<?php",
      "/** ",
      " * Nombre del Archivo: ${1:filename}.php",
      " * Descripción: ${2:Descripción de la interfaz}",
      " * ",
      " * @package    PHLEXMOD-Framework",
      " * @subpackage ${3:Backend/modules/path}",
      " * @author     JAG-Media Servicios, C.A.",
      " * @version    v2.0.1",
      " * @since      ${CURRENT_YEAR}-${CURRENT_MONTH}-${CURRENT_DATE}",
      " */",
      "?>",
      "<div class=\"container-fluid\">",
      "    <div class=\"row\">",
      "        <div class=\"col-12\">",
      "            <div class=\"card shadow-sm\">",
      "                <div class=\"card-header\">",
      "                    <h3 class=\"card-title\">${4:Título}</h3>",
      "                    <div class=\"card-tools\">",
      "                        <button type=\"button\" class=\"btn btn-tool\" data-bs-toggle=\"collapse\" data-bs-target=\"#cardBody${5}\" aria-expanded=\"true\">",
      "                            <i class=\"fas fa-minus\"></i>",
      "                        </button>",
      "                    </div>",
      "                </div>",
      "                <div id=\"cardBody${5}\" class=\"card-body collapse show\">",
      "                    ${6:<!-- Contenido Bootstrap 5.3 -->}",
      "                </div>",
      "            </div>",
      "        </div>",
      "    </div>",
      "</div>"
    ],
    "description": "Template para una vista UI con Bootstrap 5.3"
  },
  "Phlexmod UI Table (BS5.3)": {
    "prefix": "mia-ui-table",
    "body": [
      "<div class=\"table-responsive\">",
      "    <table class=\"table table-bordered table-striped table-hover align-middle\">",
      "        <thead class=\"table-light\">",
      "            <tr>",
      "                <th>${1:ID}</th>",
      "                <th>${2:Columna}</th>",
      "                <th class=\"text-center\" style=\"width: 100px;\">Acciones</th>",
      "            </tr>",
      "        </thead>",
      "        <tbody>",
      "            <tr>",
      "                <td>${3:Datos}</td>",
      "                <td>${4:Datos}</td>",
      "                <td class=\"text-center\">",
      "                    <button class=\"btn btn-sm btn-primary\" title=\"Editar\"><i class=\"fas fa-edit\"></i></button>",
      "                    <button class=\"btn btn-sm btn-danger\" title=\"Eliminar\"><i class=\"fas fa-trash\"></i></button>",
      "                </td>",
      "            </tr>",
      "        </tbody>",
      "    </table>",
      "</div>"
    ],
    "description": "Tabla responsiva con estilos Bootstrap 5.3"
  },
  "Phlexmod UI Form (BS5.3)": {
    "prefix": "mia-ui-form",
    "body": [
      "<form id=\"${1:formId}\" class=\"needs-validation\" novalidate>",
      "    <div class=\"row g-3\">",
      "        <div class=\"col-md-6\">",
      "            <label for=\"${2:inputId}\" class=\"form-label\">${3:Etiqueta}</label>",
      "            <input type=\"text\" class=\"form-control\" id=\"${2:inputId}\" name=\"${2:inputId}\" required>",
      "            <div class=\"invalid-feedback\">Por favor complete este campo.</div>",
      "        </div>",
      "        <div class=\"col-md-6\">",
      "            <label for=\"${4:selectId}\" class=\"form-label\">${5:Selección}</label>",
      "            <select class=\"form-select\" id=\"${4:selectId}\" name=\"${4:selectId}\" required>",
      "                <option selected disabled value=\"\">Elegir...</option>",
      "                <option value=\"1\">Opción 1</option>",
      "            </select>",
      "        </div>",
      "        <div class=\"col-12\">",
      "            <button class=\"btn btn-primary\" type=\"submit\"><i class=\"fas fa-save me-1\"></i> Guardar</button>",
      "        </div>",
      "    </div>",
      "</form>"
    ],
    "description": "Formulario con Grid y Validación Bootstrap 5.3"
  },
  "Phlexmod UI Modal (BS5.3)": {
    "prefix": "mia-ui-modal",
    "body": [
      "<!-- Modal -->",
      "<div class=\"modal fade\" id=\"${1:modalId}\" tabindex=\"-1\" aria-labelledby=\"${1:modalId}Label\" aria-hidden=\"true\">",
      "    <div class=\"modal-dialog modal-dialog-centered\">",
      "        <div class=\"modal-content\">",
      "            <div class=\"modal-header\">",
      "                <h5 class=\"modal-title\" id=\"${1:modalId}Label\">${2:Título del Modal}</h5>",
      "                <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>",
      "            </div>",
      "            <div class=\"modal-body\">",
      "                ${3:<!-- Contenido del Modal -->}",
      "            </div>",
      "            <div class=\"modal-footer\">",
      "                <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Cerrar</button>",
      "                <button type=\"button\" class=\"btn btn-primary\">${4:Guardar Cambios}</button>",
      "            </div>",
      "        </div>",
      "    </div>",
      "</div>"
    ],
    "description": "Estructura estándar de Modal Bootstrap 5.3"
  },
  "Phlexmod Sanitizer Post": {
    "prefix": "san-post",
    "body": [
      "\\$${1:var} = Sanitizer::post('${2:key}', ${3:default}, '${4:type}');"
    ],
    "description": "Obtener variable POST sanitizada"
  },
  "Phlexmod DB Query Params": {
    "prefix": "pg-query",
    "body": [
      "\\$sql = \"${1:Query}\";",
      "\\$res = pg_query_params(\\$conexion, \\$sql, array(${2:\\$params}));",
      "if (!\\$res) {",
      "    Logger::error('DB Error: ' . pg_last_error(\\$conexion));",
      "    throw new Exception('Error en la base de datos.');",
      "}"
    ],
    "description": "Ejecutar query parametrizado con manejo de errores seguro (Logger)"
  },
  "MIA Logger": {
    "prefix": "px-log",
    "body": [
      "Logger::${1|info,error,warning,debug|}('${2:Mensaje de log}', ${3:[]});"
    ],
    "description": "Registrar evento usando Logger Core"
  },
  "Phlexmod Log Action": {
    "prefix": "mia-log-action",
    "body": [
      "Logger::logAction('${1:ACTION_NAME}', \\$_SESSION['idLogin'] ?? 0, \"${2:Detalles}\");"
    ],
    "description": "Registrar auditoría de acción en base de datos"
  }
}